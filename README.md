> [!WARNING]
> This repository was AI-generated by Claude 4 as a one-off experiment. It may contain errors or incomplete implementations. Use at your own risk.

# JavaScript Compatibility Analyzer

A Node.js tool that downloads any webpage and analyzes its JavaScript code for browser compatibility issues. It identifies the most recent JavaScript features used and determines which browsers can support the website.

## Features

- ‚úÖ Downloads and analyzes any public webpage
- üîç Extracts both inline and external JavaScript files
- üéØ Detects browser compatibility issues using ESLint and eslint-plugin-compat
- üìä Provides detailed compatibility reports
- üé® Customizable browser targets using Browserslist format
- üíæ Saves detailed JSON reports for further analysis

## Installation

1. **Prerequisites**: Make sure you have Node.js (v14+) installed on your system.

2. **Create a new directory and navigate to it**:
```bash
mkdir js-compatibility-analyzer
cd js-compatibility-analyzer
```

3. **Save the files**: Create the three files provided:
   - `analyzer.js` (main script)
   - `package.json` (dependencies)
   - `README.md` (this file)

4. **Install dependencies**:
```bash
npm install
```

## Usage

### Basic Usage

Analyze a website with default browser targets:
```bash
node analyzer.js https://example.com
```

### iOS Safari 15.5 Specific Analysis

Target iOS Safari 15.5 specifically:
```bash
node analyzer.js https://example.com "iOS 15.5"
```

Include broader iOS Safari support:
```bash
node analyzer.js https://example.com "iOS >= 15" "Safari >= 15"
```

Conservative iOS compatibility:
```bash
node analyzer.js https://example.com "iOS >= 14" "Safari >= 14"
```

### Popular Browserslist Configurations

- **Modern browsers only**: `"last 1 version" "> 1%" "not dead"`
- **Include IE 11**: `"last 2 versions" "IE 11"`
- **Mobile focused**: `"last 2 iOS versions" "last 2 Android versions"`
- **Very conservative**: `"last 3 versions" "IE 10"`

## Example Output

```
üöÄ JavaScript Compatibility Analyzer
=====================================
üîç Analyzing JavaScript compatibility for: https://example.com
üì• Downloading webpage...
üîé Extracting JavaScript...
Found 3 JavaScript sources
üìÅ Setting up analysis files...
üî¨ Analyzing browser compatibility...

üìä Analysis Results
==================
URL: https://example.com
Timestamp: 2025-05-30T10:30:00.000Z
Total Scripts: 3
Compatibility Issues: 2

‚ö†Ô∏è  Compatibility Issues:
=========================
ERROR: script-0-inline-1.js:15:8
  Promise.all() is not supported in IE 11

ERROR: script-1-external.js:42:12
  Array.prototype.includes() is not supported in IE 11

üí≠ Recommendations:
===================
üîß Compatibility Issues Found:
   ‚Ä¢ Promise.all: 1 occurrence(s)
   ‚Ä¢ Array.prototype.includes: 1 occurrence(s)

üí° Suggestions:
   ‚Ä¢ Consider using polyfills for unsupported features
   ‚Ä¢ Update browserslist configuration to match your target audience
   ‚Ä¢ Use transpilation tools like Babel for newer JavaScript features
   ‚Ä¢ Test on actual target browsers

üìÑ Detailed report saved to: compatibility-report-1685445000000.json
```

## iOS Safari 15.5 Specific Considerations

When targeting iOS Safari 15.5, the tool now includes special analysis for:

### **Key iOS Safari 15.5 Features & Limitations:**

- ‚úÖ **Supported**: BigInt, Optional chaining, Nullish coalescing, Private class fields, Top-level await, Array.prototype.at
- ‚ùå **Not Supported**: Object.hasOwn, Array.prototype.findLast, Error.cause, BroadcastChannel, Web Locks API
- ‚ö†Ô∏è **Limited Support**: Web Audio API (requires user interaction), Fullscreen API, Clipboard API (requires user gesture)

### **Special iOS Safari Behaviors:**
- **Audio/Video**: Must be triggered by user interaction
- **Geolocation**: Requires HTTPS
- **File uploads**: Limited file type support
- **Viewport**: Special handling needed for responsive design
- **Storage**: Lower quota limits than desktop browsers

## Understanding the Output

### Summary Information
- **Total Scripts**: Number of JavaScript files/blocks found
- **Compatibility Issues**: Total number of compatibility problems detected
- **Errors vs Warnings**: Severity of issues found

### Compatibility Issues
Each issue shows:
- **File location**: Which script contains the issue
- **Line/Column**: Exact location in the code
- **Problem description**: What feature is incompatible and with which browsers

### Browser Requirements
The tool identifies the minimum browser versions needed to support all JavaScript features used on the website.

## Report Output

The tool generates a detailed JSON report containing:

```json
{
  "url": "https://example.com",
  "timestamp": "2025-05-30T10:30:00.000Z",
  "summary": {
    "totalScripts": 3,
    "compatibilityIssues": 2,
    "errors": 2,
    "warnings": 0
  },
  "javascriptSources": [...],
  "compatibilityIssues": [...],
  "browserRequirements": [...],
  "recommendations": [...]
}
```

## Programmatic Usage

You can also use this tool programmatically in your Node.js projects:

```javascript
const JavaScriptCompatibilityAnalyzer = require('./analyzer.js');

async function analyzeWebsite() {
  const analyzer = new JavaScriptCompatibilityAnalyzer();
  
  try {
    const report = await analyzer.analyze('https://example.com', [
      'last 2 Chrome versions',
      'IE 11'
    ]);
    
    console.log(`Found ${report.summary.compatibilityIssues} compatibility issues`);
    console.log(report.recommendations);
  } catch (error) {
    console.error('Analysis failed:', error.message);
  }
}

analyzeWebsite();
```

## Customization

### Modifying Browser Targets
You can customize the default browser targets by editing the `browserslist` field in `package.json` or by passing targets as command-line arguments.

### Adding Additional ESLint Rules
Modify the `eslintConfig` object in `analyzer.js` to add more compatibility rules or change severity levels.

### Extending Analysis
The tool can be extended to analyze:
- CSS compatibility (using postcss and related plugins)
- HTML5 feature usage
- Web API usage patterns
- Performance implications of compatibility choices

## Limitations

- **Public URLs only**: Can only analyze publicly accessible websites
- **Static analysis**: Detects features in code but not runtime-generated JavaScript
- **CORS restrictions**: Some external scripts may not be downloadable
- **Dynamic content**: May miss JavaScript loaded dynamically after page load

## Troubleshooting

### Common Issues

1. **"Cannot download external script"**: The script may be behind authentication or CORS restrictions
2. **"No JavaScript found"**: The page might load JavaScript dynamically or use a different structure
3. **"Analysis failed"**: Check that the URL is accessible and returns valid HTML

### Debugging

Add more verbose logging by modifying the console.log statements in the analyzer, or check the generated JSON report for detailed information.

## Contributing

Feel free to extend this tool by:
- Adding support for more JavaScript features
- Improving the analysis accuracy
- Adding support for CSS and HTML analysis
- Creating a web interface
- Adding more output formats

## License

MIT License - feel free to use and modify as needed.